---
title: Hexoä¸»é¢˜maupassantç›®å½•ä¼˜åŒ–è§£å†³æ–¹æ¡ˆ
comments: true
mathjax: true
toc: true
tocnumber: true
abbrlink: 5dd904ed
date: 2019-02-17 00:22:39
tags:
  - hexo
categories: tool
description: "ä¼˜åŒ–ç›®å½•æ˜¾ç¤ºçš„æ•´ä¸ªæŽ¢ç´¢è¿‡ç¨‹æ–­æ–­ç»­ç»­èŠ±è´¹äº†æˆ‘ä¸€äº›æ—¶é—´ï¼Œå†™ä¸‹è¿™ç¯‡æ–‡ç« è®°å½•ä¸‹è¿™ä¸ªå·¥ä½œçš„è¿‡ç¨‹ï¼Œå¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯æœ‰å€¼å¾—ä»¥åŽå­¦ä¹ çš„åœ°æ–¹ã€‚"
---

æ•´ä¸ªæŽ¢ç´¢çš„è¿‡ç¨‹æ–­æ–­ç»­ç»­èŠ±è´¹äº†æˆ‘ä¸€äº›æ—¶é—´ï¼Œå†™ä¸‹è¿™ç¯‡æ–‡ç« è®°å½•ä¸‹è¿™ä¸ªå·¥ä½œçš„è¿‡ç¨‹ï¼Œå¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯æœ‰å€¼å¾—ä»¥åŽå­¦ä¹ çš„åœ°æ–¹ã€‚

â€‹        

### é—®é¢˜

* `maupassant`ä¸»é¢˜çš„ç›®å½•æ˜¾ç¤ºåœ¨æ­£æ–‡ä¸­ï¼Œä¸€æ—¦ç›®å½•è¿‡é•¿å°±ä¼šä¸¥é‡å½±å“æ­£æ–‡çš„æŽ’ç‰ˆã€‚
* å°†ç›®å½•å›ºå®šåœ¨é¡µé¢ä¸Šçš„éœ€æ±‚

â€‹           

### æŽ¢ç´¢ä¹‹è·¯

å½“åˆé€‰ç”¨`maupassant`ä¸»é¢˜å°±æ˜¯å› ä¸ºå…¶ä¾§æ ç‰¹åˆ«ç®€çº¦å®žç”¨ï¼Œå¦‚æžœåœ¨æ‰“å¼€æ–‡ç« æµè§ˆæ—¶å°†ç›®å½•ä¹Ÿæ”¾å…¥ä¾§æ å†…é—®é¢˜ä¸å°±è§£å†³äº†å—ï¼ŸäºŽæ˜¯å¼€å§‹æ‰’ä¸»é¢˜æºç ï¼Œäº†è§£ä¾§æ çš„æœºåˆ¶å¹¶å¼€å§‹ç€æ‰‹åˆ¶ä½œç›®å½•æ ã€‚

> æ³¨ï¼šä»¥ä¸‹ä¸ºé€æ¸æŽ¢ç´¢çš„è¿‡ç¨‹ï¼Œè‹¥æƒ³ç›´æŽ¥å®Œæˆæˆ‘çš„è¿™ä¸ªæ•ˆæžœï¼Œå¯ä»¥ç›´æŽ¥ä»Žç¬¬ä¸‰å›žå¼€å§‹ã€‚

â€‹        

#### ç¬¬ä¸€å›ž

1. æ–°å»º`toc.pug`æ–‡ä»¶åœ¨`_widgets`æ–‡ä»¶å¤¹ä¸‹ï¼š
```jade
.widget
  if page.toc
    .widget-title
      i(class='fa fa-bars')= '  ' + __('contents')
     div(id='stoc' class='stoc-article')
       != toc(page.content, {list_number: theme.toc_number})
```

2. ä¹‹åŽåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶`_config.yml`ä¸­æ·»åŠ ä¾§æ `toc`ï¼š
```
widgets: 
  - toc
  - about
  - search
  - category
  - tag
  - archivelist
  - recent_posts
  - links
```

3. åœ¨`style.scss`ä¸­ä¿®æ”¹åŸºæœ¬æ ·å¼
```scss
.stoc-article {

    padding: 0.7em 0.7em 0 0;
  }

#stoc {
    line-height: 1em;
    .toc {
      padding: 0;
      margin: 0.5em;
      line-height: 1.8em;
      li {
        list-style-type: none;
      }
    }
    .toc-child {
      margin-left: 1em;
      padding-left: 0;
    }
}

```

3. æœ¬åœ°æ‰§è¡Œ`hexo server`é¢„è§ˆ

![](https://qn.hushhw.cn/images/Snipaste_2019-02-17_00-39-20.png)

â€‹      

åˆ°è¿™é‡Œæˆ‘ä»¥ä¸ºå®Œç»“æ’’èŠ±å•¦ðŸŽ‰ï¼Œå½“æˆ‘å‘å¸ƒå‡ºåŽ»åŽå‘çŽ°å¹¶æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œä¹‹åŽåšäº†åˆ¤æ–­éªŒè¯ç¡®å®žæ˜¯æ— æ³•æ˜¾ç¤ºï¼Œè¿™ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘å¾ˆä¹…ï¼Œä¸ºä»€ä¹ˆ`if page.toc`è¿™å¥åˆ¤æ–­å¤±è´¥è€Œæœ¬åœ°é¢„è§ˆå´å¯ä»¥å‘¢ï¼Ÿä¾§æ æ— æ³•è¯†åˆ«å½“å‰`page`å—ï¼Ÿ

é—®é¢˜æç½®äº†è®¸ä¹…ï¼Œé—®é¢˜æ²¡æœ‰è§£å†³å°±å¾ˆé—¹å¿ƒï¼Œä»Šå¤©åœ¨ç ”ç©¶åšå®¢æ•´ä½“æ¡†æž¶æ—¶çªç„¶æƒ³åˆ°æŠŠç›®å½•çš„é…ç½®æå‰ï¼Œæ”¾åˆ°æ–‡ç« ç”Ÿæˆå‰çš„`base.pug`æ–‡ä»¶å†…ï¼Œä»¥å¼•å…¥çš„å½¢å¼å¼•å…¥åˆ°`post.pug`èƒ½ä¸èƒ½æˆåŠŸå‘¢ï¼Ÿ

â€‹       

#### ç¬¬äºŒå›ž

1. æ–°å»º`base-post.pug`é¡µé¢ï¼ˆä¸ºäº†é¿å…ç ´åå…¶ä»–é¡µé¢çš„æŽ’ç‰ˆï¼‰ï¼Œä¸»è¦ä»£ç å¤åˆ¶äºŽ`base.pug`ï¼Œä¿®æ”¹çš„éƒ¨åˆ†å¦‚ä¸‹ï¼š
```jade
#layout.pure-g
   .pure-u-1.pure-u-md-3-4: .content_container
      block content
   if page.toc != true
     .pure-u-1.pure-u-md-1-4: #sidebar
       each item in theme.widgets
        != partial('_widget/' + item + '.pug', null, {cache: !config.relative_link})
   else
      .pure-u-1.pure-u-md-1-4: #posttoc
       	i(class='fa fa-bars')= ' TOC '
          div(id='stoc' class='stoc-article')
            != toc(page.content, {list_number: theme.toc_number})
   .pure-u-1.pure-u-md-3-4
      != partial('_partial/footer.pug')
```

ä»£ç è¿›è¡Œå‰é¢ç±»ä¼¼çš„åˆ¤æ–­ï¼Œå¦‚æžœå½“å‰æ–‡ç« åœ¨`front-matter`è®¾ç½®äº†`toc: true`å³æ˜¾ç¤ºç›®å½•ï¼Œå¦åˆ™æ˜¾ç¤ºä¾§æ ã€‚

> æ³¨ï¼šåœ¨ `post.pug` å¼€å¤´è¦ä¿®æ”¹ç»§æ‰¿çš„æ–‡ä»¶ä¸º `base-post` ã€‚

2. åœ¨`style.scss`ä¸­ä¿®æ”¹åŸºæœ¬æ ·å¼
```scss
#posttoc{
  	position: fixed;
    margin-top: 25px;
}

.stoc-article {

    padding: 0.7em 0.7em 0 0;
  }

#stoc {
    line-height: 1em;
    .toc {
      padding: 0;
      margin: 0.5em;
      line-height: 1.8em;
      li {
        list-style-type: none;
      }
    }
    .toc-child {
      margin-left: 1em;
      padding-left: 0;
    }
}

```

3. æœ¬åœ°é¢„è§ˆåŠæŽ¨é€å‘å¸ƒå‡æˆåŠŸæ˜¾ç¤ºï¼Œè¯´æ˜Žè¿™ä¸ªå°è¯•æ˜¯å¯è¡Œçš„ï¼Œç»ˆäºŽç®—æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š

![](https://qn.hushhw.cn/images/Snipaste_2019-02-17_00-11-45.png)

â€‹        

å¦å¤–ï¼Œæ˜¯å¦å¯ä»¥æŠŠç›®å½•ä¼ªè£…æˆä¾§æ ä¸­çš„ä¸€æ å‘¢ï¼Ÿ

æŠŠä»£ç æ”¹æˆå¦‚ä¸‹å³å¯ï¼š

```jade
    #layout.pure-g
      .pure-u-1.pure-u-md-3-4: .content_container
        block content
      if page.toc != true
        .pure-u-1.pure-u-md-1-4: #sidebar
          each item in theme.widgets
            != partial('_widget/' + item + '.pug', null, {cache: !config.relative_link})
      else
        .pure-u-1.pure-u-md-1-4: #sidebar
          #posttoc
            .widget
              .widget-title
                i(class='fa fa-bars')= '  ' + __('contents')
              div(id='stoc' class='stoc-article')
                != toc(page.content, {list_number: theme.toc_number})
          each item in theme.widgets
            != partial('_widget/' + item + '.pug', null, {cache: !config.relative_link})  
      .pure-u-1.pure-u-md-3-4
        != partial('_partial/footer.pug')
```

æŠŠç›®å½•çš„æ ·å¼æ”¹æˆä¾§æ ï¼Œç„¶åŽåœ¨ç›®å½•åŽé¢éåŽ†å‡ºä¾§æ å…¶å®ƒæ ç›®ã€‚

â€‹         

#### ç¬¬ä¸‰å›ž

ç»§ç»­ä¼˜åŒ–ç¬¬äºŒä¸ªé—®é¢˜å›ºå®šç›®å½•æ å¹¶ä¼˜åŒ–ç§»åŠ¨ç«¯éšè—ç›®å½•æ ã€‚

1. åœ¨ `base-post.pug` ä¸­å¢žåŠ ç§»åŠ¨ç«¯åˆ¤æ–­å¹¶ä¿®æ”¹ç±»åç­‰

```jade
#layout.pure-g
      .pure-u-1.pure-u-md-3-4: .content_container
        block content
      if page.toc != true
        .pure-u-1.pure-u-md-1-4: #sidebar
          each item in theme.widgets
            != partial('_widget/' + item + '.pug', null, {cache: !config.relative_link})
      else
        if theme.toc_on_small_screens
          .pure-u-1.pure-u-md-1-4: #sidebar-toc
            div(id="sidebar-stoc" class="stoc-article")
              strong(class="stoc-title")
                i(class='fa fa-blind')= ' Contents '
              div(id="stoc" class='toc-nav')
                != toc(page.content, {list_number: theme.toc_number})
        else 
          .pure-u-1-4.hidden_mid_and_down: #sidebar-toc
            div(id="sidebar-stoc" class="stoc-article")
              strong(class="stoc-title")
                i(class='fa fa-blind')= ' Contents '
              div(id="stoc" class='toc-nav')
                != toc(page.content, {list_number: theme.toc_number})
      .pure-u-1.pure-u-md-3-4
        != partial('_partial/footer.pug')
```

2. ä¿®æ”¹æ ·å¼

```scss
#sidebar-toc {
    padding-left: 15px;
    margin-top: 40px;
    padding-bottom: 20px;
    word-wrap: break-word;
}

.stoc-article{
    position: absolute;
    padding: 1em 1em 0 1em;
    margin-left: 1em;
    border-left: rgba(88,88,88,0.1) 1px solid;
}

.stoc-title{
    font-size: 150%;
}

#sidebar-stoc {
    width: inherit;
    line-height: 1em;
    font-size: 0.9em;
    float: left;
    overflow: auto;
}

.stoc-fixed{
  position: fixed;
  top: 60px;
  margin-top: 0;
  max-height: 81%;
  overflow: hidden;
  z-index: 1;
}


.toc-nav {
    padding: 0.7em 0.7em 0 0;
}

#stoc {
    line-height: 1em;
    .toc {
      padding: 0;
      margin: 0.5em;
      line-height: 1.8em;
      li {
        list-style-type: none;
      }
    }
    .toc-child {
      margin-left: 1em;
      padding-left: 0;
    }
}
```

3. ä¸ºäº†å®žçŽ°å›ºå®šç›®å½•çš„åŠŸèƒ½ï¼Œå¼•å…¥äº† `toc.js`æ–‡ä»¶æ”¾åœ¨`source/js`æ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åŽæ³¨æ„åœ¨ `base-post.pug` ä¸­ include è¯¥ js æ–‡ä»¶ã€‚

```js
var toc = document.getElementById('sidebar-stoc')

if (toc != null) {
	window.addEventListener("scroll", scrollcatelogHandler);
	var tocPosition = toc.offsetTop;
	var height_header = $("#header").height();
	function scrollcatelogHandler(e) {
		 var event = e || window.event,
		     target = event.target || event.srcElement;
		 var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
		 if (scrollTop >  tocPosition -60) {
		     toc.classList.add("stoc-fixed");
		 } else {
		     toc.classList.remove("stoc-fixed");
		 }
	}
}
```

å°±æ˜¯çŽ°åœ¨æ­£åœ¨ä½¿ç”¨çš„æ ·å¼å•¦ï¼

â€‹         

### æ€»ç»“

åŸºæœ¬å®žçŽ°äº†é¢„æœŸåŠŸèƒ½ï¼Œå‰åŽæŠ˜è…¾äº†å¾ˆé•¿æ—¶é—´ï¼Œä½†æ˜¯è¿™ç§å¿ƒæƒ³äº‹æˆçš„æ„Ÿè§‰è¿˜æ˜¯å¾ˆniceçš„å‘¢ï¼

åŽé¢å¦‚æžœæœ‰æ–°çš„bugå†æ…¢æ…¢è§£å†³å§ã€‚

â€‹        

### æ›´æ–°2019.2.17

ç‚¹å‡»æ— æ³•è·³è½¬ï¼Œæˆ‘æž¯äº†ã€‚ã€‚ã€‚

å¤šæ–¹æŸ¥æ‰¾åŽŸå› ç»ˆäºŽæ‰¾åˆ°äº†æ ¹æºï¼Œå±…ç„¶æ˜¯å› ä¸º`aplayeræ’­æ”¾å™¨`ä¸Ž`toc`ä¸å…¼å®¹ï¼Œè¦æ˜¯æ²¡æœ‰çœ‹åˆ°åˆ«äººçš„æ–‡ç« æˆ‘æ„Ÿè§‰ä¸€è¾ˆå­éƒ½è§£å†³ä¸äº†è¿™ä¸ª[é—®é¢˜](https://github.com/MoePlayer/hexo-tag-aplayer/issues/65)äº†ã€‚

äºŽæ˜¯æŠŠæ’­æ”¾å™¨é…ç½®è®¾ç½®å¼€å…³åœ¨`front-matter`ä¸­ï¼Œåœ¨éœ€è¦ä½¿ç”¨éŸ³ä¹æ’­æ”¾å™¨çš„é¡µé¢æ‰è®¾ä¸º`music: true`ï¼Œå…¶å®ƒç”¨åˆ°ç›®å½•çš„é¡µé¢å…³é—­ä½¿ç”¨ã€‚

â€‹          

### æ›´æ–°2019.4.3

æ»šæ¡æ—¶å¯¹åº”æ ‡é¢˜é«˜äº®ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š

åœ¨`toc.js`ä¸­å¢žåŠ å¯¹æ¯ä¸€ä¸ªæ ‡é¢˜ä½ç½®çš„åˆ¤æ–­ï¼Œå¹¶ä¸ºå…¶æ·»åŠ ä¸€ä¸ª`class`ä¸º`active`ï¼š

```javascript
var toc = document.getElementById('sidebar-stoc')
var HEADER_OFFSET = 200;
var toclink = document.getElementsByClassName('toc-link');
var headerlink = document.getElementsByClassName('headerlink');

if (toc != null) {
	window.addEventListener("scroll", scrollcatelogHandler);
	var tocPosition = toc.offsetTop;
	function scrollcatelogHandler(e) {
		 var event = e || window.event,
		     target = event.target || event.srcElement;
		 var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
		 if (scrollTop >  tocPosition -60) {
		     toc.classList.add("stoc-fixed");
		 } else {
		     toc.classList.remove("stoc-fixed");
		 }
		 for(var i=0; i<toclink.length; i++){
			//console.log(i);
			var currentHeaderTop = headerlink[i].offsetTop - HEADER_OFFSET,
				nextHeaderTop = i+1 === toclink.length ? Infinity : headerlink[i+1].offsetTop - HEADER_OFFSET;
			if(currentHeaderTop < scrollTop && scrollTop <= nextHeaderTop){
				toclink[i].classList.add('active');
			} else {
				toclink[i].classList.remove('active');
			}
		}
	}
}
```

åœ¨`style.scss`ä¸­æ·»åŠ `active`ç±»çš„æ ·å¼ï¼š

```javascript
#stoc {
    line-height: 1em;
    font-weight: 700;
    .active {
        color: #0085a1;
        border-radius: 4px;
        background-color: #F5F5F5;
    }
    .toc {
      padding: 0;
      margin: 0.5em;
      line-height: 1.8em;
      li {
        list-style-type: none;
      }
    }
    .toc-child {
      margin-left: 1em;
      padding-left: 0;
    }
}
```





