---
title: å´æ©è¾¾ã€Šæœºå™¨å­¦ä¹ ã€‹ç¬”è®°ï¼ˆä¹ï¼‰â€”â€”æ”¯æŒå‘é‡æœºSVM
comments: true
mathjax: true
toc: true
tocnumber: false
music: false
image: false
date: 2019-08-23 12:32:50
tags:
  - Machine Learning
categories:
  - ç¬”è®°æ•´ç†
  - æœºå™¨å­¦ä¹ 
---



## Support Vector Machines

### 12.1. Optimization Objective

**æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machinesï¼ŒSVMï¼‰**åœ¨å­¦ä¹ å¤æ‚çš„éçº¿æ€§æ–¹ç¨‹æ—¶æä¾›äº†ä¸€ç§æ›´ä¸ºæ¸…æ™°æ›´ä¸ºå¼ºå¤§çš„æ–¹å¼ï¼Œå±äºç›‘ç£å­¦ä¹ ç®—æ³•ã€‚

ä¸ºäº†æè¿° SVMï¼Œæˆ‘ä»¬ä» logistic å›å½’å¼€å§‹ï¼Œä¸‹å›¾æ˜¯å›é¡¾ logistic å›å½’çš„å‡è®¾å‡½æ•°çš„ä¸€äº›ç‰¹æ€§ï¼š

![](https://photo.hushhw.cn/20190906130133.png)

å†çœ‹çœ‹ logistic å›å½’çš„ä»£ä»·å‡½æ•°ï¼š
$$
\begin{align}
J(\theta) &= \frac{1}{m}\sum^{m}_{i=1}\left[-y^{(i)}log\ h_{\theta}(x^{(i)}) - (1-y^{(i)})log(1-h_{\theta}(x^{(i)}))\right] \\
&= \frac{1}{m}\sum^{m}_{i=1}\left[-y^{(i)}log\left( \frac1{1+e^{-\theta^Tx^{(i)}}}\right) - (1-y^{(i)})log\left(1-\frac1{1+e^{-\theta^Tx^{(i)}}}\right)\right]
\end{align}
$$
ä»¤ $z=\theta^Txâ€‹$ åç”»å‡ºä¸¤æ¡å…‰æ»‘çš„ sigmoid å‡½æ•°æ›²çº¿å¦‚ä¸‹å›¾ï¼š

![](https://photo.hushhw.cn/20190906132048.png)

ç”¨ä¸¤æ¡ç²‰è‰²çº¿æ®µä»£æ›¿æ›²çº¿ï¼Œè¿™è¢«ç§°ä¸º hinge loss å‡½æ•°ã€‚

* å½“ y = 1 æ—¶ï¼Œå‘½åä¸º $cost_1(z)$ ï¼Œå½“ z å¤§äº 1 æ—¶ä¸ºé›¶ï¼Œå°äº 1 æ—¶æ–œç‡å¯ä»¥ä¸ç”¨è€ƒè™‘ã€‚

* å½“ y = 0 æ—¶ï¼Œå‘½åä¸º $cost_0(z)$ ï¼Œå½“ z å°äº -1 æ—¶ä¸ºé›¶ï¼Œå¤§äº -1 æ—¶æ–œç‡å¯ä»¥ä¸ç”¨è€ƒè™‘ã€‚

logistic å›å½’æ­£åˆ™åŒ–åçš„å¾…è§å‡½æ•°ä¸ºï¼š
$$
J(\theta) = \frac{1}{m}\sum^{m}_{i=1}\left[y^{(i)}\left(-log\ h_{\theta}(x^{(i)})\right) + (1-y^{(i)})\left(-log(1-h_{\theta}(x^{(i)}))\right)\right] + \frac{\lambda}{2m}\sum^n_{j=1}\theta^2_j 
$$
ç”¨å‘½ååçš„çº¿æ®µä»£æ›¿ logistic å›å½’ä»£ä»·å‡½æ•°çš„ç¬¬ä¸€é¡¹å’Œç¬¬äºŒé¡¹å¾—åˆ°ï¼š
$$
J(\theta) = \frac{1}{m}\sum^{m}_{i=1}\left[y^{(i)}cost_1(\theta^Tx^{(i)}) + (1-y^{(i)})cost_0(\theta^Tx^{(i)})\right] + \frac{\lambda}{2m}\sum^n_{j=1}\theta^2_j 
$$
ç°åœ¨æˆ‘ä»¬è€ƒè™‘å»æ‰ 1/m è¿™ä¸€é¡¹ï¼Œå»æ‰åä¾ç„¶å¯ä»¥å¾—åˆ°åŒæ ·çš„ ğœƒ æœ€ä¼˜å€¼ï¼Œå› ä¸º 1/m ä»…æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚æˆ‘ä»¬åšä¸€ä¸‹å˜å½¢ï¼Œä¹˜ä»¥ä¸€ä¸ª m/Î»ï¼š
$$
J(\theta) = \frac{1}{\lambda}\sum^{m}_{i=1}\left[y^{(i)}cost_1(\theta^Tx^{(i)}) + (1-y^{(i)})cost_0(\theta^Tx^{(i)})\right] + \frac12\sum^n_{j=1}\theta^2_j
$$
æœ€åæˆ‘ä»¬è®° C=1/Î»ï¼Œå¾—åˆ°ï¼š
$$
J(\theta) = C\sum^{m}_{i=1}\left[y^{(i)}cost_1(\theta^Tx^{(i)}) + (1-y^{(i)})cost_0(\theta^Tx^{(i)})\right] + \frac12\sum^n_{j=1}\theta^2_j
$$
è¿™å°±æ˜¯é€šå¸¸ä½¿ç”¨çš„ SVM ä»£ä»·å‡½æ•°ï¼Œè¿™ä¸ªç³»æ•° C æœ¬è´¨ä¸Šå’Œ Î» ä¸€æ ·ï¼Œéƒ½æ˜¯æ”¹å˜æ™®é€šä»£ä»·å‡½æ•°é¡¹å’Œæ­£åˆ™é¡¹çš„æƒé‡å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åŠ å¼ºæ­£åˆ™åŒ–å¼ºåº¦æ¥å¤„ç†è¿‡æ‹Ÿåˆï¼Œé‚£ä¹ˆå‡å° Cï¼›å¦‚æœæƒ³è¦å‡å°‘æ­£åˆ™åŒ–å¼ºåº¦æ¥å¤„ç†æ¬ æ‹Ÿåˆï¼Œé‚£ä¹ˆå¢å¤§ Cã€‚

æœ€åï¼Œæœ‰åˆ«äº logistic å›å½’çš„ä¸€ç‚¹æ˜¯ SVM ç®—æ³•çš„å‡è®¾å‡½æ•°å¹¶ä¸ä»£è¡¨ y = 0 æˆ– 1 çš„æ¦‚ç‡ï¼Œè€Œåªæ˜¯è¾“å‡º 0 æˆ– 1ï¼š
$$
h_{\theta}(x)= \begin{cases}
1 \quad if\: \theta^Tx\geq0 \\
0 \quad otherwise
\end{cases}
$$
â€‹           

### 12.2. Large Margin Intuition

æŠŠ SVM ç®—æ³•å½“ä½œ**å¤§é—´è·åˆ†ç±»å™¨ï¼ˆLarge Margin Classifierï¼‰**æ¥ç†è§£æ˜¯æ¯”è¾ƒç›´è§‚çš„ç†è§£æ–¹å¼ã€‚

ä¸‹å›¾å›é¡¾äº† SVM ç®—æ³•çš„æœ€å°åŒ–ä»£ä»·å‡½æ•°çš„ç»“è®ºï¼š

![](https://photo.hushhw.cn/20190906144938.png)

å¦‚æœä»£ä»·å‡½æ•°ä¸­çš„ C è¢«è®¾ç½®çš„éå¸¸éå¸¸å¤§ï¼Œæƒ³è¦æ˜¯çš„ä»£ä»·å‡½æ•°æœ€å°ï¼Œå°±å¿…é¡»è®©ä»£ä»·å‡½æ•°é¡¹ä¸º 0 ï¼Œå³ï¼š
$$
\begin{align}
J(\theta) &= C\cdot0 + \frac12\sum^n_{j=1}\theta^2_j \\
when: \quad&\theta^Tx^{(i)}\geq 1 \quad if \:y^{(i)}=1 \\
&\theta^Tx^{(i)}\leq -1 \quad if \:y^{(i)}=0 \\
\end{align}
$$
![](https://photo.hushhw.cn/20190906150428.png)

åœ¨ä¸Šå›¾çš„å†³ç­–è¾¹ç•Œé€‰æ‹©ä¸­ï¼Œé»‘çº¿å†³ç­–è¾¹ç•Œçš„é€‰æ‹©æ˜¯ç¬¦åˆ SVM ç®—æ³•è¦æ±‚çš„ï¼Œé»‘çº¿æœ‰ä¸æ­£è´Ÿæ•°æ®é›†æ›´å¤§çš„è·ç¦»ï¼Œè¿™ä¸ªè·ç¦»å«åšæ”¯æŒå‘é‡æœºçš„**é—´è·ï¼ˆmarginï¼‰**ï¼Œå› æ­¤æ”¯æŒå‘é‡æœºæœ‰æ—¶è¢«ç§°ä¸º**å¤§é—´è·åˆ†ç±»å™¨ï¼ˆLarge Margin Classifierï¼‰**ã€‚åœ¨ SVM ç®—æ³•ä¸­ï¼Œå†³ç­–è¾¹ç•Œçš„æ€§è´¨æ˜¯å°½å¯èƒ½åœ°è¿œç¦»æ­£æ•°æ®é›†ä¸è´Ÿæ•°æ®é›†ã€‚

äº‹å®ä¸Šï¼Œæ”¯æŒå‘é‡æœº SVM ç°åœ¨æ¯”å¤§é—´è·åˆ†ç±»å™¨è¦æˆç†Ÿå¾—å¤šï¼Œä½¿ç”¨å¤§é—´è·åˆ†ç±»å™¨çš„å­¦ä¹ ç®—æ³•å®¹æ˜“å—åˆ°å¼‚å¸¸ç‚¹ï¼ˆoutlierï¼‰çš„å½±å“ï¼Œå¦‚ä¸‹å›¾ä¸­ä¼šå› ä¸ºä¸€ä¸ªå¼‚å¸¸ç‚¹å¯¼è‡´å†³ç­–è¾¹ç•Œå‘ç”Ÿå¾ˆå¤§çš„åç§»ã€‚

![](https://photo.hushhw.cn/20190906151419.png)

å¦‚æœæƒ³è¦ä½¿å¾—è¿™äº›å¼‚å¸¸ç‚¹ä¸è¿‡åˆ†å½±å“å†³ç­–è¾¹ç•Œï¼Œè¿™æ—¶åº”è¯¥å‡å° C çš„æ•°å€¼ã€‚

